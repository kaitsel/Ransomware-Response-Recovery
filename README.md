# Ransomware: Lifecycle and Forensic Timeline

## Project Overview

This project will provide a step-by-step theoretical guide to the six main phases that occur during a ransomware attack. This will include definitions, coding, and screenshots, documenting the changes committed to a local desktop that has been infected by an adversary. Following this, a comprehensive forensic timeline will be created, taking a different outside perspective to show where and when the signs of this attack were detected. The expected outcome will include four sections/repositories, which will showcase everything from the attack phases to the recommendations on how to mitigate the risk of this attack occurring again. 

## Relevancy

It is important to illustrate and understand this process today due to the ever-increasing ransomware attacks faced by major corporations in the United Kingdom, such as Co-Op and M&S. During the course of completing this project, another attack occurred, breaching the data of London's major retail store, Harrods. This has significant effects on a company's reputation with its customers and investors. The failure in compliance with regulations such as NIST, ISO, SANS, and the GDPR can cost an extra monetary expense over the amount in damages, threatening to take down business chains, putting thousands of employees at risk of termination. Our world is only increasing the amount that takes place over the Internet, with less and less in-person shopping. This creates a significant threat to these companies, and the need to increase security to get ahead of adversaries is an undeniable must in this technological age. 

## Case Study: NHS Ransomware Attack

- Attack Type: Ransomware through Phishing
- Attack Timeline: September 22 - October 29, 2025
- Industry: National Health Service
- Assets: Patient Personal Details (including full names, date of birth, and NHS insurance numbers) 
- Compliance Issue: HIPAA (Health Insurance Portability and Accountability Act)

## Methodology

### Infrastructure

- Oracle VirtualBox
- Windows 11 (64-bit)

### Tools Used

- Command Prompt (Administrator Level)
- DB Browser for SQLite
- Event Viewer
- Mimikatz
- PowerShell (Administrator Level)
- Registry Editor
- Steganography Online
- Visual Studio Code Insiders v. 1.105 with Python package
- Wireshark
- Zenmap
- Zsteg through Aperisolve

### Setup 

- The Windows 11 machine was booted up through the Oracle VirtualBox, ready for use.
- A user1 account was created, separate from the admin, to illustrate a typical employee in the NHS office with limited access rights. A basic password was created for this user (PAssw0rd1!).
- An email address was created for this user to be able to receive the phishing scam.
- An adversary email was developed under a randomly generated name, Mike McAdamms. This allows for user1 to receive the phishing email.
- All built-in Windows tools were activated automatically through initial installation. Attack tools were downloaded during the phases and are discussed further in their sections. The forensic tools were downloaded prior to the analysis stage.

### Constraints and Limitations

All malicious code is either illustrative or temporary due to ethical and legal issues. Due to this device being used for other means besides running the virtual machine, fully developed ransomware code was not used to ensure the safety of the software. All code will be within the bounds of the virtual machine and will not affect the computer that is hosting. The system will be connected to the Internet through an Ethernet cable; however, the device will have no access to a wider network, ensuring any issues that may arise are contained and can be mitigated locally. All recommendations within this project should not be used for malicious purposes and have been done for educational use to explore what causes certain flags within a system and what and how things can be broken to gain malicious access.

## Sources

- MITRE ATT&CK (2025) https://attack.mitre.org/
- National Vulnerability Database, CVE-2023-36874 (2023) https://nvd.nist.gov/vuln/detail/cve-2023-36874

## Contents

- **[attack_phases.md](attack_phases.md)** - Analyses and mapping of each step in the attack lifecycle.
- **[evidence_artefacts.md](evidence_artefacts.md)** - Catalogue of evidence collected during attack phases.
- **[forensic_timeline.md](forensic_timeline.md)** - A record of events generated by using a series of forensic tools and techniques.
- **[recovery_recommendations.md](recovery_recommendations.md)** - A researched overview of the recommended initial response and suggested controls to implement.

# Results

# Conclusion

There is a high importance for security nowadays, which has influenced today's software, as shown by the Windows infrastructure that was used. It contained a sophisticated virus protection, which impacted some attack manoeuvres negatively, which then had to be rectified by either taking a different avenue or shutting it down long enough to make it through. This was successful, which is an issue. A company cannot rely on the given firewalls and antivirus software to keep its systems safe. There needs to be a vast defence-in-depth as discussed through the suggested controls to prevent, detect, and correct any instance of malware. Adversaries are able to adapt to the present prevention methods, and if this remains unchanged, then holes will start to appear as malicious actors test the edges of the barrier to find a weak spot. This is what happened to Co-Op, M&S, and the recent Harrods case, which was caused by a supplier. These attacks require constant vigilance through training, auditing, and patching to keep sensitive data secure. To protect the evolving digital world, due diligence is a required skill for forensic investigators, security administrators, and general users to avoid setting off the initial domino in the attack sequence. 
